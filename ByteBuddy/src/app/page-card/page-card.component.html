<div class="card hover:shadow-lg transition-all duration-200 group">
    <!-- Page Header -->
    <div class="card-content space-y-4">
        <div class="flex items-start justify-between">
            <div class="flex-1 min-w-0 cursor-pointer" (click)="onViewPage()">
                <h3 class="text-xl font-semibold text-foreground truncate group-hover:text-primary-600 transition-colors">
                    {{ page.title }}
                </h3>
                <p class="text-sm text-muted-foreground mt-1">
                    {{ getRelativeTime(page.createdAt) }} â€¢ {{ getFormattedDate(page.createdAt) }}
                </p>
            </div>

            <!-- Actions Menu -->
            <div *ngIf="showActions && isAuthenticated()" class="flex items-center space-x-2 opacity-0 group-hover:opacity-100 transition-opacity">
                <button
                    *ngIf="canEditPage()"
                    (click)="onEditPage()"
                    class="btn-ghost btn-sm p-2"
                    title="Edit page"
                >
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                    </svg>
                </button>
                <button
                    *ngIf="canEditPage()"
                    (click)="onDeletePage()"
                    class="btn-ghost btn-sm p-2 text-error-600 hover:text-error-700 hover:bg-error-50"
                    title="Delete page"
                >
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                    </svg>
                </button>
            </div>
        </div>

        <!-- Page Image -->
        <div *ngIf="page.imageUrl" class="cursor-pointer" (click)="onViewPage()">
            <img
                [src]="page.imageUrl"
                [alt]="page.title"
                class="w-full h-48 object-cover rounded-lg border border-border hover:opacity-95 transition-opacity"
                loading="lazy"
                (error)="onImageError($event)"
            />
        </div>

        <!-- Page Description -->
        <div class="cursor-pointer" (click)="onViewPage()">
            <p class="text-muted-foreground text-sm leading-relaxed line-clamp-3">
                {{ page.description || 'No description provided.' }}
            </p>
        </div>

        <!-- Author Info -->
        <div *ngIf="showAuthor && page.createdBy" class="flex items-center justify-between pt-3 border-t border-border">
            <div 
                class="flex items-center space-x-3 cursor-pointer hover:opacity-80 transition-opacity"
                (click)="onViewAuthor()"
            >
                <!-- Avatar -->
                <div class="w-8 h-8 bg-gradient-to-br from-primary-500 to-accent-500 rounded-full flex items-center justify-center text-white text-sm font-medium">
                    {{ getAuthorDisplayName().charAt(0).toUpperCase() }}
                </div>
                
                <!-- Author Details -->
                <div class="min-w-0">
                    <p class="text-sm font-medium text-foreground truncate">
                        {{ getAuthorDisplayName() }}
                    </p>
                    <p class="text-xs text-muted-foreground truncate">
                        @{{ page.createdBy.userName }}
                    </p>
                </div>
            </div>

            <!-- Like Button -->
            <div class="flex items-center space-x-3">
                <!-- Like Count (Clickable to view likers) -->
                <button
                    *ngIf="page.likesCount > 0"
                    (click)="toggleLikers()"
                    class="text-xs text-muted-foreground hover:text-primary-600 transition-colors"
                    [class.text-primary-600]="showLikers"
                >
                    {{ page.likesCount }} like{{ page.likesCount !== 1 ? 's' : '' }}
                </button>

                <!-- Like Button -->
                <button
                    *ngIf="isAuthenticated()"
                    (click)="onLikePage()"
                    [disabled]="isLiking"
                    class="btn-ghost btn-sm p-2 group/like"
                    [class.text-error-500]="page.isLikedByCurrentUser"
                    [title]="page.isLikedByCurrentUser ? 'Unlike page' : 'Like page'"
                >
                    <svg 
                        class="w-5 h-5 transition-all duration-200 group-hover/like:scale-110" 
                        viewBox="0 0 24 24"
                        [class.fill-current]="page.isLikedByCurrentUser"
                        fill="none" 
                        stroke="currentColor"
                    >
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                    </svg>
                    <div *ngIf="isLiking" class="absolute inset-0 flex items-center justify-center">
                        <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-primary-500"></div>
                    </div>
                </button>
            </div>
        </div>

        <!-- Likers List -->
        <div 
            *ngIf="showLikers && likers.length > 0" 
            class="pt-3 border-t border-border animate-slide-down"
        >
            <div class="space-y-2">
                <p class="text-sm font-medium text-foreground">Liked by:</p>
                <div class="flex flex-wrap gap-2">
                    <div 
                        *ngFor="let liker of likers.slice(0, 6)"
                        class="flex items-center space-x-2 bg-muted/50 rounded-lg px-3 py-1"
                    >
                        <div class="w-5 h-5 bg-gradient-to-br from-primary-500 to-accent-500 rounded-full flex items-center justify-center text-white text-xs font-medium">
                            {{ (liker.firstName?.charAt(0) || liker.userName?.charAt(0) || 'U').toUpperCase() }}
                        </div>
                        <span class="text-xs text-foreground">
                            {{ liker.firstName && liker.lastName ? liker.firstName + ' ' + liker.lastName : liker.userName }}
                        </span>
                    </div>
                    <div 
                        *ngIf="likers.length > 6"
                        class="flex items-center bg-muted/50 rounded-lg px-3 py-1"
                    >
                        <span class="text-xs text-muted-foreground">
                            +{{ likers.length - 6 }} more
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
